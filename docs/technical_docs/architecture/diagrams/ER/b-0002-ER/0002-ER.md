---
title: Diagrama ER - V2
---

Esta versão do diagrama Entidade-Relacionamento foi desenvolvida com base nas especificações do [UML V4](/docs/technical_docs/architecture/diagrams/uml/d-0004-UML/0004-UML.md), incorporando melhorias significativas na estrutura de dados e alinhamento com a BNCC.

## Atualizações

- [x] Migração para UUID em todas as tabelas
- [x] Padronização de campos para inglês
- [x] Campo `color` para personalização visual (disciplines, tags)
- [x] Campo `difficulty` em questions para classificação por nível
- [x] Campo `duration_minutes` em question_collections
- [x] Entidade `skills` para competências BNCC
- [x] Auto-relacionamento em users (created_by, updated_by)
- [x] Entidade `content_attachments` para PDFs e arquivos
- [x] Hierarquia de tópicos (parent_topic_id)
- [x] Relacionamento explícito Discipline -> Skill
- [x] Relacionamento explícito Discipline -> Topic
- [x] Tabela pivot `question_collection_class_pivot` para atribuições
- [x] Campos de auditoria (created_at, updated_at, created_by, updated_by)
- [x] Remoção de `content_images` (imagens em base64 no body)

## Principais Mudanças em Relação à V1

### Novas Entidades
- **skills** - Habilidades BNCC por disciplina
- **skill_topics** - Relacionamento entre competências e tópicos
- **content_attachments** - Anexos (PDFs, docs) separados do conteúdo
- **question_collection_class_pivot** - Controle de atribuições de coleções às turmas

### Relacionamentos Aprimorados
- `Discipline 1:N Skill` - Disciplinas definem competências BNCC
- `Discipline 1:N Topic` - Organização hierárquica clara
- `Topic N:N Skill` (via skill_topics) - Mapeamento flexível de competências
- `User N:N User` - Auto-relacionamento para criação/edição
- `Class N:N QuestionCollection` (via pivot) - Atribuições com metadados

### Campos Removidos
- `content_images` - Substituído por base64 no campo `body`
- `content_image_pivot` - Não mais necessário

## Estrutura Funcional

O banco está organizado em 5 módulos:

1. **Gestão de Usuários** - system_users
2. **Estrutura Curricular** - disciplines, skills, topics, skill_topics
3. **Conteúdos** - contents, content_types, content_attachments, content_tags
4. **Gestão de Turmas** - classes, user_classes
5. **Sistema de Avaliações** - question_collections, questions, alternatives, question_answers

## Diagrama ER

![ER V4](/img/diagrams/ER/0002-ER/0002-ER/0002-ER.svg)

---

**Versão:** 2.0  
**Data:** 07/12/2025