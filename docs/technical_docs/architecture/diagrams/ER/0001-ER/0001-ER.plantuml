@startuml ER_Diagram

enum TypeSystemUser {
  PROFESSOR
  ALUNO
  ADMIN
  MODERADOR
  OPERADOR
}

enum StatusSystemUser {
  ATIVO
  BLOQUEADO
  INATIVO
}

enum StatusConteudo {
  RASCUNHO
  ATIVO
  INATIVO
}

enum TipoQuestao {
  MULTIPLA
  VERDADEIRO_FALSO
  ABERTA
}

enum StatusQuestao {
  ATIVO
  INATIVO
}

enum TipoAtividade {
  PROVA
  SIMULADO
  ATIVIDADE
}

enum StatusAtividade {
  ATIVO
  INATIVO
}

enum StatusTurma {
  ATIVO
  INATIVO
}

entity "system_user" as user {
  * id : int {PK}
  --
  name : string
  email : string
  password : string
  type : TypeSystemUser
  status : StatusSystemUser
  criador : int {FK}
  ultimo_editor : int {FK}
  --
  created_at : datetime
  updated_at : datetime
}

entity "materias" as materias {
  * id : int {PK}
}

entity "conteudos" as conteudos {
  * id : int {PK}
  --
  title : string
  content : longText
  status : StatusConteudo
  published_at : datetime
  id_materia : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "content_types" as content_types {
  * id : int {PK}
  --
  title : string
  description : string
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "content_tags" as content_tags {
  * id : int {PK}
  --
  tag_name : string
  is_moderator_only : boolean
  count : integer
  description : string
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "content_image" as content_image {
  * id : int {PK}
  --
  file_name : string
  file_path : string
  alt_text : string
  base64_data : string
  mime_type : string
  --
  created_at : datetime
  updated_at : datetime
}

entity "questoes" as questoes {
  * id : int {PK}
  --
  titulo : string
  corpo : string
  tipo : TipoQuestao
  status : StatusQuestao
  id_materia : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "alternativas" as alternativas {
  * id : int {PK}
  --
  valor : string
  correta : boolean
  status : StatusQuestao
  id_questao : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "atividades" as atividades {
  * id : int {PK}
  --
  nome : string
  tipo : TipoAtividade
  status : StatusAtividade
  prazoFinal : datetime
  id_materia : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "atividades_questoes" as atividades_questoes {
  * id : int {PK}
  --
  id_atividade : int {FK}
  id_questao : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "turmas" as turmas {
  * id : int {PK}
  --
  nome : string
  limite : int
  status : StatusTurma
  id_responsavel : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

entity "turma_alunos" as turma_alunos {
  * id : int {PK}
  --
  id_turma : int {FK}
  id_aluno : int {FK}
  --
  criador : int {FK}
  ultimo_editor : int {FK}
  created_at : datetime
  updated_at : datetime
}

user ||--o{ conteudos : "criador/editor"
user ||--o{ content_tags : "criador/editor"
user ||--o{ content_types : "criador/editor"
user ||--o{ questoes : "criador/editor"
user ||--o{ alternativas : "criador/editor"
user ||--o{ atividades : "criador/editor"
user ||--o{ atividades_questoes : "criador/editor"
user ||--o{ turmas : "criador/editor"
user ||--o{ turma_alunos : "criador/editor"
user ||--o{ turmas : "responsavel"
user ||--o{ turma_alunos : "aluno"

materias ||--o{ conteudos : "contém"
conteudos ||--o{ content_tags : "tem"
conteudos ||--o{ content_image : "contém"
conteudos }o--|| content_types : "tem"

questoes }o--|| materias : "contém"
questoes ||--o{ alternativas : "contém"
questoes }o--o{ atividades : "incluída em"

atividades }o--|| materias : "pertence"
atividades ||--o{ atividades_questoes : "contém"
atividades }o--o{ turmas : "atribuída"

turmas ||--o{ turma_alunos : "contém"

user -- TypeSystemUser : "type"
user -- StatusSystemUser : "status"
conteudos -- StatusConteudo : "status"
questoes -- TipoQuestao : "tipo"
questoes -- StatusQuestao : "status"
alternativas -- StatusQuestao : "status"
atividades -- TipoAtividade : "tipo"
atividades -- StatusAtividade : "status"
turmas -- StatusTurma : "status"

@enduml